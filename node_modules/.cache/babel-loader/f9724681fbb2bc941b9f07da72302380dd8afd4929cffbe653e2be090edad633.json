{"ast":null,"code":"import { NOOP } from '../_util/constant';\nfunction getBody(xhr) {\n  var text = xhr.responseText || xhr.response;\n  if (!text) {\n    return text;\n  }\n  try {\n    return JSON.parse(text);\n  } catch (e) {\n    return text;\n  }\n}\nvar uploadRequest = function uploadRequest(options) {\n  var _a = options.onProgress,\n    onProgress = _a === void 0 ? NOOP : _a,\n    _b = options.onError,\n    onError = _b === void 0 ? NOOP : _b,\n    _c = options.onSuccess,\n    onSuccess = _c === void 0 ? NOOP : _c,\n    action = options.action,\n    _d = options.headers,\n    headers = _d === void 0 ? {} : _d,\n    originName = options.name,\n    file = options.file,\n    _e = options.data,\n    originData = _e === void 0 ? {} : _e,\n    _f = options.withCredentials,\n    withCredentials = _f === void 0 ? false : _f;\n  function getValue(value) {\n    if (typeof value === 'function') {\n      return value(file);\n    }\n    return value;\n  }\n  var name = getValue(originName);\n  var data = getValue(originData);\n  var xhr = new XMLHttpRequest();\n  if (onProgress && xhr.upload) {\n    xhr.upload.onprogress = function (event) {\n      var percent;\n      if (event.total > 0) {\n        percent = event.loaded / event.total * 100;\n      }\n      onProgress(parseInt(percent, 10), event);\n    };\n  }\n  xhr.onerror = function error(e) {\n    onError(e);\n  };\n  xhr.onload = function onload() {\n    if (xhr.status < 200 || xhr.status >= 300) {\n      return onError(getBody(xhr));\n    }\n    onSuccess(getBody(xhr));\n  };\n  var formData = new FormData();\n  if (data) {\n    Object.keys(data).map(function (key) {\n      return formData.append(key, data[key]);\n    });\n  }\n  formData.append(name || 'file', file);\n  xhr.open('post', action, true);\n  if (withCredentials && 'withCredentials' in xhr) {\n    xhr.withCredentials = true;\n  }\n  for (var h in headers) {\n    if (headers.hasOwnProperty(h) && headers[h] !== null) {\n      xhr.setRequestHeader(h, headers[h]);\n    }\n  }\n  xhr.send(formData);\n  return {\n    abort: function abort() {\n      xhr.abort();\n    }\n  };\n};\nexport default uploadRequest;","map":{"version":3,"names":["NOOP","getBody","xhr","text","responseText","response","JSON","parse","e","uploadRequest","options","_a","onProgress","_b","onError","_c","onSuccess","action","_d","headers","originName","name","file","_e","data","originData","_f","withCredentials","getValue","value","XMLHttpRequest","upload","onprogress","event","percent","total","loaded","parseInt","onerror","error","onload","status","formData","FormData","Object","keys","map","key","append","open","h","hasOwnProperty","setRequestHeader","send","abort"],"sources":["D:/Code/EchoGPT-frontend/node_modules/@arco-design/web-react/es/Upload/request.js"],"sourcesContent":["import { NOOP } from '../_util/constant';\nfunction getBody(xhr) {\n    var text = xhr.responseText || xhr.response;\n    if (!text) {\n        return text;\n    }\n    try {\n        return JSON.parse(text);\n    }\n    catch (e) {\n        return text;\n    }\n}\nvar uploadRequest = function (options) {\n    var _a = options.onProgress, onProgress = _a === void 0 ? NOOP : _a, _b = options.onError, onError = _b === void 0 ? NOOP : _b, _c = options.onSuccess, onSuccess = _c === void 0 ? NOOP : _c, action = options.action, _d = options.headers, headers = _d === void 0 ? {} : _d, originName = options.name, file = options.file, _e = options.data, originData = _e === void 0 ? {} : _e, _f = options.withCredentials, withCredentials = _f === void 0 ? false : _f;\n    function getValue(value) {\n        if (typeof value === 'function') {\n            return value(file);\n        }\n        return value;\n    }\n    var name = getValue(originName);\n    var data = getValue(originData);\n    var xhr = new XMLHttpRequest();\n    if (onProgress && xhr.upload) {\n        xhr.upload.onprogress = function (event) {\n            var percent;\n            if (event.total > 0) {\n                percent = (event.loaded / event.total) * 100;\n            }\n            onProgress(parseInt(percent, 10), event);\n        };\n    }\n    xhr.onerror = function error(e) {\n        onError(e);\n    };\n    xhr.onload = function onload() {\n        if (xhr.status < 200 || xhr.status >= 300) {\n            return onError(getBody(xhr));\n        }\n        onSuccess(getBody(xhr));\n    };\n    var formData = new FormData();\n    if (data) {\n        Object.keys(data).map(function (key) { return formData.append(key, data[key]); });\n    }\n    formData.append(name || 'file', file);\n    xhr.open('post', action, true);\n    if (withCredentials && 'withCredentials' in xhr) {\n        xhr.withCredentials = true;\n    }\n    for (var h in headers) {\n        if (headers.hasOwnProperty(h) && headers[h] !== null) {\n            xhr.setRequestHeader(h, headers[h]);\n        }\n    }\n    xhr.send(formData);\n    return {\n        abort: function () {\n            xhr.abort();\n        },\n    };\n};\nexport default uploadRequest;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}